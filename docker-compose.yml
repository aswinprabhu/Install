version: '2'
services:
  ui:
    build:
      context: .
      dockerfile: DockerfileUI
      args:
        CORE_URL: "http://192.168.1.4:8000"
    ports:
      - "80:80"
    restart: always
    depends_on:
      - core
      - executor
    links:
      - core
  core:
    build:
      context: .
      dockerfile: DockerfilePF
      args:
        WEB_URL: "http://192.168.1.4"
        EXECUTOR_URL: "http://192.168.1.4:8080"
        CORE_URL: "http://192.168.1.4:8000"
    ports:
      - "8000:80"
    restart: always
    volumes:
      - /platform:/var/cloudbox/platform
      - /domain:/var/cloudbox/domain
    links:
      - executor
  executor:
    build:
      context: .
      dockerfile: DockerfileExecutor
      args:
        EXECUTOR_URL: "http://192.168.1.4:8080"
        CORE_URL: "http://192.168.1.4:8000"
    ports:
      - "8080:8080"
    restart: always
    volumes:
      - /domain:/var/cloudbox/domain
